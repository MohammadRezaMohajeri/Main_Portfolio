<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    Advanced Shiny Application for scRNA-seq Analysis: Cell-Type-Specific HVG Identification & Comprehensive Functional Analysis with High-Quality Visualizations
  </title>

  <!-- ============ favicon icon ============ -->
  <link rel="icon" type="image/x-icon" href="https://mohammadrezamohajeri.github.io/Breast-Cancer-Gene-Expression-Biomarker-Analysis/Images/1.ico">

  <!-- ============ Prism.js code styling ============ -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.5.0/prism-dracula.min.css" rel="stylesheet">

  <style>
    /* ======== Highlight animation ======== */
    .highlight {
      animation: highlightAnimation 5s ease-out;
    }

    @keyframes highlightAnimation {
      from {
        background-color: yellow;
      }
      to {
        background-color: transparent;
      }
    }

    /* ======== Selection color ======== */
    ::selection {
      background-color: yellow;
      color: black;
    }

    /* ======== Responsive YouTube Video ======== */
    .video-container {
      position: relative;
      width: 90%;
      max-width: 900px;
      margin: 20px auto;
    }

    .video-container iframe {
      width: 100%;
      height: auto;
      aspect-ratio: 16 / 9;
    }

    /* ======== General Styles ======== */
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 20px;
      background-color: #f9f9f9;
      text-align: justify;
    }

    .header {
      background-color: #344a5e;
      color: white;
      padding: 10px 0;
      text-align: center;
      position: relative;
    }

    .header h1 {
      font-size: 34px;
      line-height: 1.5;
      margin: 20px auto;
      padding: 20px;
      max-width: 90%;
      word-wrap: break-word;
    }

    .home-link {
      position: absolute;
      bottom: 10px;
      left: 10px;
      text-decoration: none;
      z-index: 1;
    }

    .title {
      font-size: 26px;
      font-weight: bold;
      margin: 20px 0;
      text-align: center;
    }

    .explanation {
      font-size: 24px;
      margin-bottom: 20px;
    }

    h3, h4, h5 {
      margin-top: 60px;
      margin-bottom: 5px;
    }

    .code-caption {
      font-size: 16px;
      font-style: italic;
      margin-bottom: 1px;
      color: #555;
      text-align: justify;
    }

    .code-block {
      margin-bottom: 20px;
      font-size: 16px;
    }

    pre[class*="language-"] {
      font-size: 16px;
    }

    figure {
      margin-bottom: 30px;
    }

    ul {
      margin-top: 0 !important;
      margin-bottom: 0 !important;
      padding-left: 20px !important;
    }

    li {
      margin-bottom: 5px !important;
    }

    hr {
      border: none;
      border-top: 1px solid black;
      margin: 20px 0;
    }

    /* ============ Responsive Adjustments ============ */
    @media only screen and (max-width: 768px) {
      .header h1 {
        font-size: 20px;
        line-height: 1.3;
        padding: 10px;
      }

      .explanation {
        font-size: 18px;
        padding: 0 10px;
      }

      body {
        margin: 10px;
      }

      .home-link img {
        width: 40px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <a href="https://mohammadrezamohajeri.github.io/Main_Portfolio/index.html" class="home-link">
      <img src="Pictures/Home_Link_JPG/1.jpg" alt="Home" style="width:50px; height:auto;">
    </a>
    <h1>
      Advanced Shiny Application for scRNA-seq Analysis: <br> 
      Cell-Type-Specific HVG Identification & <br>
      Comprehensive Functional Analysis <br>
      (with High-Quality Visualizations)
    </h1>
  </div>

  <div class="body">
    <hr>

    <!-- ======== Embedded Video ======== -->
    <div class="video-container" style="text-align: center; margin-bottom: 20px;">
      <iframe
        src="https://www.youtube.com/embed/Rlkej_DH2F0?si=Hc1MUAv9_IIbT6CC"
        title="A Shiny App for Biomarker Identification"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        referrerpolicy="strict-origin-when-cross-origin"
        allowfullscreen>
      </iframe>
    </div>


    
<div class="explanation">
  <h3>An Interactive Shiny App for Biomarker Identification: Cell-Type-Specific HVGs & Functional Analysis in Single-cell RNA-Sequencing</h3>
  <ul>
    <li><strong>Introduction:</strong>
      <ul>
        <li>Single-cell RNA-seq (scRNA-seq) reveals cell-level transcriptomic variation critical for understanding disease microenvironments.</li>
        <li>This application is developed and tested using kidney cancer scRNA-seq data (10x Genomics, ICB-treated), and is adaptable to other diseases with similar input structure (matrix, genes, barcodes, metadata).</li>
        <li>Identifying HVGs within subpopulations (e.g., non-responder, responder, tumor or immune cells) highlights genes involved in resistance mechanisms, immune activity, or treatment efficacy.</li>
        <li>Combined with other gene lists (e.g., from DEA), HVGs help isolate informative genes for building predictive ML/DL models.</li>
        <li>The tool simplifies metadata-driven analysis, enabling rapid insights into cell-type-specific biology relevant to drug discovery.</li>
      </ul>
    </li>

    <li><strong>Objective:</strong>
      <ul>
        <li>To develop an interactive platform for dynamic identification of highly variable genes (HVGs) within selected cell types, enabling functional enrichment analysis (GSEA and ORA for GO terms and KEGG pathways) and biomarker discovery.</li>
        <li>To provide an accessible, real-time tool that supports both experimental and computational researchers through flexible input, intuitive design, export-ready outputs, and dynamic metadata integration.</li>
        <li>The app extracts metadata columns and their unique values (e.g., ICB_Response: ICB_PR, ICB_SD, ICB_PD), allowing users to subset cells of interest, identify HVGs, perform functional analyses (GO and KEGG), and iteratively compare gene sets and enriched pathways.</li>
      </ul>
    </li>

    <li><strong>Methods:</strong>
      <ul>
        <li>This Shiny app, built in R (2,000+ code lines, runs via RStudio), was developed and tested on 10x Genomics kidney cancer data (ICB therapy).</li>
        <li>It covers six steps: from data upload to HVG identification and functional enrichment (GO/KEGG via GSEA & ORA).</li>
        <li>While tested on kidney cancer, it’s adaptable to other datasets and diseases. Enables cell-type-specific HVG detection and pathway analysis.</li>
        <li>This application leverages a range of R packages to support its functionality, interactivity, and analytical depth. The core framework is built using <strong>(1) Shiny</strong>, enabling a dynamic user interface and server-side reactivity. <strong>(2) shinyjs</strong> is included to allow additional JavaScript-based interactivity, such as enabling/disabling UI components or custom behaviors. <strong>(3) Seurat</strong> powers the preprocessing pipeline, including normalization, filtering, HVG identification, and matrix handling for scRNA-seq data. <strong>(4) ggplot2</strong> is used extensively for generating high-quality, customizable visualizations across different stages of analysis. Metadata manipulation, filtering, and transformation are handled with <strong>(5) dplyr</strong>, <strong>(6) tidyr</strong>, and <strong>(7) readr</strong> for clean and efficient data wrangling. Sparse matrices from 10x Genomics are processed using the <strong>(8) Matrix</strong> package. Functional enrichment analyses (ORA and GSEA) are performed using <strong>(9) clusterProfiler</strong> and <strong>(10) msigdbr</strong>, with gene annotations retrieved via <strong>(11) org.Hs.eg.db</strong>. The visualization of enrichment results is supported by <strong>(12) enrichplot</strong>, <strong>(13) ComplexHeatmap</strong>, <strong>(14) wordcloud</strong>, <strong>(15) RColorBrewer</strong>, and <strong>(16) circlize</strong>, enabling outputs such as dot plots, bar charts, cnetplots, enrichment maps, and term clouds. Additional utilities include <strong>(17) data.table</strong> for fast data import. These packages collectively provide a robust backend for interactive scRNA-seq biomarker discovery and visualization.</li>


      </ul>
    </li>

    <li><strong>Results:</strong>
      <ul>
        <li><strong>1- Data Import to HVG Identification (Step 1–5):</strong> After uploading and integrating the scRNA-seq data and metadata, quality control filtering and normalization reduced noise and improved data consistency. Interactive cell selection based on metadata allowed focused analysis on specific biological groups. From the filtered subset, highly variable genes were identified, representing key drivers of transcriptional variability across the selected cells and forming the basis for downstream functional analysis.</li>
        <li><strong>2- Functional Enrichment Analysis (Step 6):</strong> Functional analysis of HVGs in progressive disease (PD) cells revealed enriched GO terms and KEGG pathways linked to extracellular matrix structure and immune processes. GO terms included collagen-containing extracellular matrix, structural molecule activity, complement activation, and humoral immune response. KEGG pathways such as ECM-receptor interaction, focal adhesion, and cytokine–cytokine receptor interaction were also enriched. Notable HVGs associated with these pathways included COL1A1, FN1, MMP2, C3, IGHM, and IL1B.</li>
      </ul>
    </li>

    <li><strong>Discussion:</strong>
      <ul>
        <li>High-variance genes (HVGs) enriched in PD cells suggest an immune-evasive and fibrotic tumor environment.</li>
        <li>GO and KEGG analyses consistently revealed extracellular matrix remodeling (e.g., COL1A1, FN1, SPARC) via terms like ECM-receptor interaction and focal adhesion, pointing to enhanced structural barriers against immune infiltration.</li>
        <li>Complement-related and humoral immune genes (C3, C1QA, IGHA1) imply chronic inflammation and immune dysfunction, while chemokine and cytokine signaling terms suggest altered immune cell trafficking.</li>
        <li>Leukocyte migration and antigen presentation pathways (CXCL10, HLADRB1) indicate ongoing immune activity, yet potentially ineffective, consistent with ICB resistance.</li>
        <li>These insights align with mechanisms of immune exclusion and resistance in progressive kidney cancer.</li>
      </ul>
    </li>

    <li><strong>Conclusions:</strong>
      <ul>
        <li>This app streamlines scRNA-seq preprocessing, QC, normalization, and HVG identification via an interactive interface.</li>
        <li>By integrating metadata with the count matrix, it enables dynamic cell-type subsetting, functional enrichment (GO/KEGG via GSEA and ORA), and biomarker discovery—supporting experimental and computational researchers with real-time, flexible analysis.</li>
      </ul>
    </li>

    <li><strong>Future Work:</strong>
      <ul>
        <li>Adapting and evaluating the app across additional disease contexts beyond ICB-treated kidney cancer.</li>
        <li>Adding capabilities for differential expression analysis, HVG–DEG comparison, and functional analysis of shared genes.</li>
      </ul>
    </li>

    <li><strong>References:</strong>
      <ul>
        <li>1. Bi et al. (2021). Tumor and immune reprogramming during immunotherapy in advanced renal cell carcinoma. <i>Cancer Cell</i>, 39(5):649–661.e5.</li>
        <li>2. Chen & Mellman (2017);</li>
        <li>3. Mariathasan et al. (2018);</li>
        <li>4. Roumenina et al. (2019);</li>
        <li>5. Kuen et al. (2017)</li>
      </ul>
    </li>

    <li><strong>Acknowledgements:</strong>
      <ul>
        <li>I sincerely thank Professor Claudio Angione (Professor of AI and Co-Lead of the Centre for Digital Innovation, and recipient of a Turing Network Development Award funded by The Alan Turing Institute in 2022 and 2023) and Dr. Annalisa Occhipinti (Associate Professor), Teesside University, for their guidance and inspiration during our collaborative project on scRNA-seq analysis in kidney cancer, which laid the foundation for this work.</li>
      </ul>
    </li>
  </ul>
</div>

    
    <hr>
  </div>
</body>
</html>
