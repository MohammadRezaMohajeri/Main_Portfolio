<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A Bioinformatics Pipeline for Biologically Relevant HVG Selection in scRNA-seq Data for Training Predictive DL Models</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 40px;
      background-color: #f9f9f9;
      color: #333;
    }
    h1, h2, h3 {
      color: #004080;
    }
    h1 {
      font-size: 24px;
      margin-bottom: 10px;
    }
    h2 {
      font-size: 20px;
      margin-top: 30px;
      margin-bottom: 10px;
    }
    h3 {
      font-size: 16px;
      margin-top: 20px;
    }
    ul {
      list-style-type: disc;
      margin-left: 20px;
    }
    .summary {
      font-style: italic;
      margin-bottom: 30px;
    }
    .figure-placeholder {
      color: #888;
      font-style: italic;
      margin: 10px 0;
    }
    hr {
      margin: 40px 0;
    }
  </style>
</head>
<body>
  <h1>A Bioinformatics Pipeline for Biologically Relevant HVG Selection in scRNA-seq Data for Training Predictive DL Models</h1>
  <div class="summary">
    A flexible and biologically informed pipeline that refines highly variable genes from single-cell RNA-seq data to optimize deep learning model training.
  </div>

  <h2>1. Introduction</h2>
  <p>In high-dimensional single-cell transcriptomic datasets, selecting meaningful input features for machine learning or deep learning (DL) models poses a significant challenge. Standard approaches typically rely on selecting the top 2,000 to 5,000 highly variable genes (HVGs) using purely statistical criteria. However, many of these genes may be noisy or unrelated to the specific biological context, such as the disease type or therapy being studied.</p>
  <p>To address this limitation, we developed a bioinformatics pipeline tailored for single-cell RNA-seq (scRNA-seq) data in 10X format (i.e., genes, barcodes, and matrix files). This pipeline integrates statistical variability with biological relevance by benchmarking HVG sets against a curated list of genes known to be involved in context-specific pathways. In doing so, it helps researchers derive more robust and interpretable gene sets for model training.</p>
  <p>The motivation behind this pipeline stems from the need to better align computational feature selection with biological insight. Instead of relying solely on enrichment analyses post hoc, we proactively incorporate pathway- and GO-term-based biological knowledge derived from literature. This biologically anchored approach increases the interpretability and accuracy of predictive models.</p>
  <p>While the initial use case involved kidney cancer patients treated with immune checkpoint blockade (ICB) therapy, the pipeline is designed to be generalizable. Users can adjust pathway and GO term selections to suit other diseases and treatment modalities.</p>

  <h2>2. Pipeline Overview</h2>
  <ul>
    <li>Step 1: Extract HVGs from selected cells</li>
    <li>Step 2: Determine the optimal HVG set by evaluating biological relevance</li>
    <li>Step 3: Generate a refined gene list by intersecting the HVG set with biologically relevant genes</li>
  </ul>
  <p class="figure-placeholder">Figure 2.1. Schematic diagram of the biologically guided HVG selection pipeline. (To be added later.)</p>

  <h2>3. Step-by-Step Breakdown</h2>
  <h3>3.1 Step One: Generate HVG Sets</h3>
  <p>The pipeline starts with scRNA-seq input files in 10X format. Users can specify which cell populations to includeâ€”for instance, based on therapy response categories such as partial response (PR), stable disease (SD), or progressive disease (PD). The selected cells are saved into a new directory.</p>
  <p>Using Seurat, the pipeline calculates HVGs and saves them incrementally in sets of 100, from 100 up to 9,000. These sets represent candidate feature spaces for downstream evaluation.</p>
  <p class="figure-placeholder">Figure 3.1. Distribution of HVGs in each incremental set. (To be added later.)</p>

  <h3>3.2 Step Two: Assess Biological Relevance of HVG Sets</h3>
  <p>In this step, each HVG set is benchmarked against a reference list of biologically meaningful genes. These genes are extracted using the biomaRt and msigdbr R packages, based on a curated set of GO terms and immunotherapy-relevant pathways identified through literature review.</p>
  <p>The pipeline calculates how many genes in each HVG set overlap with this reference list. This allows us to measure not only variability but also biological interpretability. The goal is to find the "elbow point" or inflection threshold where adding more HVGs no longer substantially increases the number of biologically relevant genes captured.</p>
  <p class="figure-placeholder">Figure 3.2. Curve showing overlap between HVG sets and immune-related genes. (To be added later.)</p>

  <h3>3.3 Step Three: Extract Biologically Relevant HVGs for Model Training</h3>
  <p>After identifying the optimal HVG set (e.g., 5,000 genes), the pipeline intersects it once more with the reference gene list. The result is a refined gene set that is both statistically variable and biologically informed, and is now ready to be used as input for deep learning or machine learning models.</p>
  <p class="figure-placeholder">Figure 3.3. Final refined gene list visualization. (To be added later.)</p>

  <h2>4. Output and Results</h2>
  <p>The final output consists of a biologically curated list of highly variable genes in .csv format. These genes can be directly used as input for training DL models that aim to predict treatment response or classify cell states.</p>
  <p>Additionally, the pipeline outputs figures showing HVG distributions, overlap with reference genes, and threshold determination. These help users assess the performance and adaptability of the pipeline in their own datasets.</p>
  <p>The pipeline was initially tested on scRNA-seq data from kidney cancer patients undergoing ICB therapy. However, its modular design supports broader use across other diseases and treatment types. Users can swap in GO terms and pathways that are specific to cardiovascular diseases, infectious diseases, other cancers, or therapies like chemotherapy.</p>
  <p>This adaptability ensures that while the pipeline maintains a biologically grounded methodology, it can flexibly support diverse biological questions and experimental designs.</p>
</body>
</html>
