<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extracting Text from a PDF to a Word Document using PyPDF2 & pdfplumber</title>
    <style>
        /* Basic Styles */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f9f9f9;
        }

        /* Header Style */
        .header {
            background-color: #01031f;
            color: white;
            padding: 10px 0;
            text-align: center;
        }

        /* Title Style */
        .title {
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            text-align: center;
        }

        /* Explanation Text Style */
        .explanation {
            margin-bottom: 20px;
        }

        /* Code Block Style */
        .code-block {
            background-color: #f4f4f4;
            padding: 15px;
            border-left: 5px solid #333;
            font-family: "Courier New", Courier, monospace;
            margin-bottom: 20px;
            white-space: pre-wrap; /* Preserve whitespace and line breaks */
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>Other Works & Innovations</h1>
    </div>

    <div class="title">
        Extracting text from a PDF to a Word Document using PyPDF2 & pdfplumber libraries in Python
    </div>

    <div class="body">
        <div class="explanation">
            <h3>1. Importing Required Libraries</h3>
            <p>First, we need to import the necessary libraries that will help us manipulate PDF files and create a Word document. The libraries we are using are:</p>
            <ul>
                <li><strong>PyPDF2</strong>: Used for reading and working with PDF files.</li>
                <li><strong>pdfplumber</strong>: Provides a more robust way to extract text from PDFs.</li>
                <li><strong>python-docx</strong>: Allows us to create and manipulate Word documents (.docx files).</li>
            </ul>
            <p>Here's the code to import these libraries:</p>
        </div>

        <div class="code-block">
            # ================== Importing Required Libraries ==================<br>
            # Import necessary libraries for PDF processing and Word document creation<br>
            import PyPDF2<br>
            import pdfplumber<br>
            from docx import Document
        </div>

        <div class="explanation">
            <h3>2. Defining File Paths and Page Range</h3>
            <p>Next, the user needs to define the file paths for the input PDF and output Word document, as well as the range of pages they wish to extract. This step sets the variables that will be used throughout the process:</p>
            <ul>
                <li><strong>file_name</strong>: The full path to the PDF file.</li>
                <li><strong>output_word_file</strong>: The full path for the output Word document, including the .docx extension.</li>
                <li><strong>page_range</strong>: The range of pages to extract, specified as a string (e.g., '1-12' for pages 1 to 12).</li>
            </ul>
            <p>Here's the code for this section:</p>
        </div>

        <div class="code-block">
            # ================== Define File Paths and Page Range ==================<br>
            # Define the path to the PDF file, the output Word file, and the range of pages to extract<br>
            file_name = r'C:\\Users\\omidm\\OneDrive\\Desktop\\Clifton_Agreement.pdf'<br>
            output_word_file = r'C:\\Users\\omidm\\OneDrive\\Desktop\\extracted_Clifton_Agreement2.docx'<br>
            page_range = '1-12'  # Specify the page range to extract, e.g., '1-12' for pages 1 to 12
        </div>

        <div class="explanation">
            <h3>3. Function to Extract PDF Pages and Save as Word</h3>
            <p>This is the main function of the script. It performs the following tasks:</p>
            <ul>
                <li><strong>Opening the PDF File</strong>: It opens the PDF file in binary read mode.</li>
                <li><strong>Parsing the Page Range</strong>: The page range is parsed to handle both single pages and ranges of pages.</li>
                <li><strong>Adjusting for Zero-Indexing</strong>: PyPDF2 uses zero-based indexing, so the page numbers are adjusted accordingly.</li>
                <li><strong>Validating the Page Range</strong>: It checks if the specified page range is valid within the document.</li>
                <li><strong>Creating a Word Document</strong>: Initializes a new Word document where the extracted text will be stored.</li>
                <li><strong>Extracting and Adding Text</strong>: Extracts text from each page in the specified range and adds it to the Word document.</li>
                <li><strong>Saving the Word Document</strong>: Finally, it saves the Word document to the specified location.</li>
            </ul>
            <p>Here’s the code for this function:</p>
        </div>

        <div class="code-block">
            # ================== Function to Extract PDF Pages and Save as Word ==================<br>
            def extract_pdf_to_word(file_name, page_range, output_word_file):<br>
                &nbsp;&nbsp;&nbsp;&nbsp;# Open the PDF file in read-binary mode<br>
                &nbsp;&nbsp;&nbsp;&nbsp;with open(file_name, 'rb') as pdf_file:<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdf_reader = PyPDF2.PdfReader(pdf_file)<br><br>

                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Parse the page range input<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if '-' in page_range:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page, end_page = map(int, page_range.split('-'))  # Handle a range of pages<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page = end_page = int(page_range)  # Handle a single page<br><br>

                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Adjust for zero-indexing used by PyPDF2 (subtract 1 from each page number)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page -= 1<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end_page -= 1<br><br>

                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Validate the page range<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if start_page < 0 or end_page >= len(pdf_reader.pages) or start_page > end_page:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("Invalid page range.")  # Print an error message if the range is invalid<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return  # Exit the function if the range is not valid<br><br>

                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ================== Create a Word Document ==================<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc = Document()  # Initialize a new Word document<br><br>

                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ================== Extract and Add Text from Each Page ==================<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with pdfplumber.open(file_name) as pdf:  # Open the PDF with pdfplumber<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for page_num in range(start_page, end_page + 1):<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page = pdf.pages[page_num]  # Access the page<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text = page.extract_text()  # Extract text from the page<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if text:<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.add_paragraph(text)  # Add the extracted text to the Word document<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.add_paragraph("No text found on page.")  # Handle pages with no text<br><br>

                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ================== Save the Word Document ==================<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.save(output_word_file)  # Save the Word document to the specified file<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Pages {start_page + 1} to {end_page + 1} have been extracted to {output_word_file}")  # Confirmation message<br>
        </div>

        <div class="explanation">
            <h3>4. Calling the Function</h3>
            <p>Finally, the script calls the <strong>extract_pdf_to_word</strong> function with the predefined variables. This triggers the entire process of extracting text from the PDF and saving it into a Word document.</p>
            <p>Here’s the code to call the function:</p>
        </div>

        <div class="code-block">
            # ================== Call the Function with Predefined Variables ==================<br>
            extract_pdf_to_word(file_name, page_range, output_word_file)  # Call the function with the specified inputs
        </div>

        <div class="explanation">
            <h3>Summary</h3>
            <p><strong>Importing Required Libraries</strong>: The first step involves importing the necessary libraries.</p>
            <p><strong>Defining File Paths and Page Range</strong>: The user specifies the input/output file paths and the page range.</p>
            <p><strong>Main Function</strong>: This function handles the core tasks of extracting the specified pages and saving them to a Word document.</p>
            <p><strong>Function Call</strong>: The script concludes by calling the function with the predefined settings, executing the extraction process.</p>
            <p>This structured explanation and corresponding code sections make it easier to understand the flow of the script and the purpose of each part.</p>
        </div>
    </div>

</body>
</html>
